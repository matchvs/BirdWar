{"version":3,"sources":["../../../../../assets/common/lobby/assets/common/lobby/roomUserInfo.js"],"names":["mvs","require","GLB","cc","Class","extends","Component","properties","userName","default","type","Label","ownerTag","Node","otherTag","selfTag","defaultNode","commonNode","kick","userIcon","Sprite","init","active","string","on","kickPlayer","userId","clientEvent","eventType","playerAccountGet","userInfoSet","setData","ownerId","userInfo","id","isRoomOwner","Game","GameManager","userInfoReq","recvMsg","console","log","account","headIcon","loader","load","url","err","texture","spriteFrame","SpriteFrame","Rect","width","height","bind","onDestroy","off","engine"],"mappings":"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","file":"roomUserInfo.js","sourceRoot":"../../../../../assets/common/lobby","sourcesContent":["var mvs = require(\"Matchvs\");\nvar GLB = require(\"Glb\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        userName: {\n            default: null,\n            type: cc.Label\n        },\n        ownerTag: {\n            default: null,\n            type: cc.Node\n        },\n        otherTag: {\n            default: null,\n            type: cc.Node\n        },\n        selfTag: {\n            default: null,\n            type: cc.Node\n        },\n        defaultNode: {\n            default: null,\n            type: cc.Node\n        },\n        commonNode: {\n            default: null,\n            type: cc.Node\n        },\n        kick: {\n            default: null,\n            type: cc.Node\n        },\n        userIcon: {\n            default: null,\n            type: cc.Sprite\n        }\n    },\n\n    init: function() {\n        this.defaultNode.active = true;\n        this.otherTag.active = false;\n        this.ownerTag.active = false;\n        this.selfTag.active = false;\n        this.userName.string = '';\n        this.commonNode.active = false;\n        this.kick.active = false;\n        this.kick.on(\"click\", this.kickPlayer, this);\n        this.userId = 0;\n        clientEvent.on(clientEvent.eventType.playerAccountGet, this.userInfoSet, this);\n    },\n\n    setData: function(userId, ownerId) {\n        this.userId = userId;\n        if (this.userId === ownerId) {\n            this.ownerTag.active = true;\n            this.otherTag.active = false;\n            this.selfTag.active = false;\n        } else if (this.userId === GLB.userInfo.id) {\n            this.ownerTag.active = false;\n            this.otherTag.active = false;\n            this.selfTag.active = true;\n        } else {\n            this.ownerTag.active = false;\n            this.otherTag.active = true;\n            this.selfTag.active = false;\n        }\n        this.defaultNode.active = false;\n        this.commonNode.active = true;\n        this.userName.string = this.userId;\n\n        if (!GLB.isRoomOwner || this.userId === GLB.userInfo.id) {\n            this.kick.active = false;\n        } else {\n            this.kick.active = true;\n        }\n        Game.GameManager.userInfoReq(this.userId);\n    },\n\n    userInfoSet: function(recvMsg) {\n        console.log(\"recvMsg:\" + recvMsg);\n        if (recvMsg.account == this.userId) {\n            console.log(\"set user info\");\n            console.log(recvMsg);\n            this.userName.string = recvMsg.userName;\n            if (recvMsg.headIcon && recvMsg.headIcon !== \"-\") {\n                cc.loader.load({url: recvMsg.headIcon, type: 'png'}, function(err, texture) {\n                    var spriteFrame = new cc.SpriteFrame(texture, cc.Rect(0, 0, texture.width, texture.height));\n                    if(this.userIcon) {\n                        this.userIcon.spriteFrame = spriteFrame;\n                    }\n                }.bind(this));\n            }\n        }\n    },\n\n    onDestroy() {\n        clientEvent.off(clientEvent.eventType.playerAccountGet, this.userInfoSet, this);\n    },\n\n    kickPlayer: function() {\n        mvs.engine.kickPlayer(this.userId, \"kick\");\n    }\n});\n"]}